<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>blog</title>
  
  <subtitle>追梦青年</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://tgluon.github.io/"/>
  <updated>2018-07-27T16:53:59.199Z</updated>
  <id>https://tgluon.github.io/</id>
  
  <author>
    <name>tang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>加载json文件到hive表</title>
    <link href="https://tgluon.github.io/2018/07/28/%E5%8A%A0%E8%BD%BDjson%E6%96%87%E4%BB%B6%E5%88%B0hive%E8%A1%A8/"/>
    <id>https://tgluon.github.io/2018/07/28/加载json文件到hive表/</id>
    <published>2018-07-27T16:43:23.000Z</published>
    <updated>2018-07-27T16:53:59.199Z</updated>
    
    <content type="html"><![CDATA[<h1 id="struct类型应用"><a href="#struct类型应用" class="headerlink" title="struct类型应用"></a>struct类型应用</h1><h2 id="准备json文件"><a href="#准备json文件" class="headerlink" title="准备json文件"></a>准备json文件</h2><p>simple.json<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"foo"</span>:<span class="string">"abc"</span>,<span class="attr">"bar"</span>:<span class="string">"200901011000000"</span>,<span class="attr">"quux"</span>:&#123;<span class="attr">"quuxid"</span>:<span class="number">1234</span>,<span class="attr">"quuxname"</span>:<span class="string">"sam"</span>&#125;&#125;</span><br></pre></td></tr></table></figure></p><h2 id="添加hive-hcatalog-core-jar包"><a href="#添加hive-hcatalog-core-jar包" class="headerlink" title="添加hive-hcatalog-core.jar包"></a>添加hive-hcatalog-core.jar包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add jar /home/hadoop/hive/lib/hive-hcatalog-core.jar</span><br></pre></td></tr></table></figure><h2 id="建立测试表"><a href="#建立测试表" class="headerlink" title="建立测试表"></a>建立测试表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> mytest;</span><br><span class="line"><span class="keyword">use</span> mytest;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span>  my_table(</span><br><span class="line">   foo <span class="keyword">string</span>,</span><br><span class="line">   bar <span class="keyword">string</span>,</span><br><span class="line">   quux <span class="keyword">struct</span>&lt;quuxid:<span class="built_in">int</span>,quuxname:<span class="keyword">string</span>&gt;</span><br><span class="line">) </span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> serde <span class="string">'org.apache.hive.hcatlog.data.JsonSerde'</span></span><br><span class="line"><span class="keyword">stored</span> <span class="keyword">as</span> textfile;</span><br></pre></td></tr></table></figure><h2 id="装载数据"><a href="#装载数据" class="headerlink" title="装载数据"></a>装载数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/home/hadoop/data/simple.json'</span> <span class="keyword">into</span> <span class="keyword">table</span> my_table;</span><br></pre></td></tr></table></figure><h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> foo, bar,quux.quuxid,quux.quuname <span class="keyword">from</span> my_table;</span><br></pre></td></tr></table></figure><h1 id="sstruct结合array类型应用"><a href="#sstruct结合array类型应用" class="headerlink" title="sstruct结合array类型应用"></a>sstruct结合array类型应用</h1><h2 id="准备json文件-1"><a href="#准备json文件-1" class="headerlink" title="准备json文件"></a>准备json文件</h2><p>complex.json<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;"docid":"abc","user":&#123;"id":123,"username":"saml1234","name":"sam","shippingaddress":&#123;"address1":"123mainst","address2:""","city":"durham","state":"nc"&#125;,"orders":[&#123;"itemid":6789,"orderdate":"11/11/2012"&#125;,&#123;"itemid":4352,"orderdate"："12/12/2012"&#125;]&#125;&#125;</span><br></pre></td></tr></table></figure></p><h2 id="添加hive-hcatalog-core-jar包-1"><a href="#添加hive-hcatalog-core-jar包-1" class="headerlink" title="添加hive-hcatalog-core.jar包"></a>添加hive-hcatalog-core.jar包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add jar /home/hadoop/hive/lib/hive-hcatalog-core.jar</span><br></pre></td></tr></table></figure><h2 id="建立测试表-1"><a href="#建立测试表-1" class="headerlink" title="建立测试表"></a>建立测试表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> mytest;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span>  <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> complex_json(</span><br><span class="line"> docid <span class="keyword">string</span>,</span><br><span class="line"> <span class="keyword">user</span> <span class="keyword">struct</span>&lt;<span class="keyword">id</span>: <span class="built_in">int</span>,</span><br><span class="line">      username: <span class="keyword">string</span>,</span><br><span class="line">      shippingaddress:<span class="keyword">struct</span>&lt;address1:<span class="keyword">string</span></span><br><span class="line">           address2: <span class="keyword">string</span>,</span><br><span class="line">           city: <span class="keyword">string</span>,</span><br><span class="line">           state: <span class="keyword">string</span>&gt;,</span><br><span class="line">           orders:<span class="built_in">array</span>&lt;<span class="keyword">struct</span>&lt;itemid:<span class="built_in">int</span>,orderdate:<span class="keyword">String</span>&gt;&gt;&gt;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> serde <span class="string">'org.apache.hive.hcatlog.data.JsonSerde'</span></span><br><span class="line"><span class="keyword">stored</span> <span class="keyword">as</span> textfile;</span><br></pre></td></tr></table></figure><h2 id="装载数据-1"><a href="#装载数据-1" class="headerlink" title="装载数据"></a>装载数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> inpath <span class="string">'/home/hadoop/data/complex.json'</span> overwrite <span class="keyword">table</span> complex_json;</span><br></pre></td></tr></table></figure><h2 id="查询-1"><a href="#查询-1" class="headerlink" title="查询"></a>查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> docid,user.id,user.shippingaddress.city <span class="keyword">as</span> city ,user.orders[<span class="number">0</span>].itemid <span class="keyword">as</span> order0id,user.orders[<span class="number">1</span>].itemid <span class="keyword">as</span> order1ib    </span><br><span class="line"><span class="keyword">from</span> complex_json;</span><br></pre></td></tr></table></figure><h1 id="动态map类型应用"><a href="#动态map类型应用" class="headerlink" title="动态map类型应用"></a>动态map类型应用</h1><h2 id="json文件"><a href="#json文件" class="headerlink" title="json文件"></a>json文件</h2><p>a.json<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"conflict"</span>:&#123;<span class="attr">"liveid"</span>:<span class="number">123</span>,<span class="attr">"zhuboid"</span>:<span class="string">"456"</span>,<span class="attr">"media"</span>:<span class="number">789</span>,<span class="attr">"proxy"</span>:<span class="string">"ac"</span>,<span class="attr">"result"</span>:<span class="number">10000</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">"conflict"</span>:&#123;<span class="attr">"liveid"</span>:<span class="number">123</span>,<span class="attr">"zhuboid"</span>:<span class="string">"456"</span>,<span class="attr">"media"</span>:<span class="number">789</span>,<span class="attr">"proxy"</span>:<span class="string">"ac"</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">"conflict"</span>:&#123;<span class="attr">"liveid"</span>:<span class="number">123</span>,<span class="attr">"zhuboid"</span>:<span class="string">"456"</span>,<span class="attr">"media"</span>:<span class="number">789</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">"conflict"</span>:&#123;<span class="attr">"liveid"</span>:<span class="number">123</span>,<span class="attr">"zhuboid"</span>:<span class="string">"456"</span>&#125;&#125;</span><br><span class="line">&#123;<span class="attr">"conflict"</span>:&#123;<span class="attr">"liveid"</span>:<span class="number">123</span>&#125;&#125;</span><br></pre></td></tr></table></figure></p><h2 id="添加hive-hcatalog-core-jar包-2"><a href="#添加hive-hcatalog-core-jar包-2" class="headerlink" title="添加hive-hcatalog-core.jar包"></a>添加hive-hcatalog-core.jar包</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add jar /home/hadoop/hive/lib/hive-hcatalog-core.jar</span><br></pre></td></tr></table></figure><h2 id="建立测试表-2"><a href="#建立测试表-2" class="headerlink" title="建立测试表"></a>建立测试表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> mytest;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> json_table(</span><br><span class="line">    conflict <span class="keyword">map</span>&lt;<span class="keyword">string</span>,<span class="keyword">string</span>&gt;</span><br><span class="line">)</span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> serde <span class="string">'org.apache.hive.hcatlog.data.JsonSerde'</span></span><br><span class="line"><span class="keyword">stored</span> <span class="keyword">as</span> textfile;</span><br></pre></td></tr></table></figure><h2 id="查询-2"><a href="#查询-2" class="headerlink" title="查询"></a>查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> json_table;   </span><br><span class="line"><span class="keyword">select</span> conflict[<span class="string">'media'</span>] <span class="keyword">from</span> json_table;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;struct类型应用&quot;&gt;&lt;a href=&quot;#struct类型应用&quot; class=&quot;headerlink&quot; title=&quot;struct类型应用&quot;&gt;&lt;/a&gt;struct类型应用&lt;/h1&gt;&lt;h2 id=&quot;准备json文件&quot;&gt;&lt;a href=&quot;#准备json文件&quot; cla
      
    
    </summary>
    
      <category term="hive" scheme="https://tgluon.github.io/categories/hive/"/>
    
    
      <category term="hive" scheme="https://tgluon.github.io/tags/hive/"/>
    
  </entry>
  
  <entry>
    <title>大数据平台监控工具</title>
    <link href="https://tgluon.github.io/2018/07/24/%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/"/>
    <id>https://tgluon.github.io/2018/07/24/监控工具/</id>
    <published>2018-07-24T10:19:59.000Z</published>
    <updated>2018-07-24T10:39:00.771Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大数据平台监控工具"><a href="#大数据平台监控工具" class="headerlink" title="大数据平台监控工具"></a>大数据平台监控工具</h1><h2 id="Prometheus-grafana"><a href="#Prometheus-grafana" class="headerlink" title="Prometheus+grafana"></a>Prometheus+grafana</h2><p><code>环境搭建参考博客：</code></p><blockquote><p><a href="http://blog.51cto.com/youerning/2050543" target="_blank" rel="noopener">http://blog.51cto.com/youerning/2050543</a>   </p></blockquote><h2 id="cerebro"><a href="#cerebro" class="headerlink" title="cerebro"></a>cerebro</h2><p><code>作为本地监控，监控elasticsearch</code>     </p><blockquote><p><a href="https://github.com/lmenezes/cerebro" target="_blank" rel="noopener">https://github.com/lmenezes/cerebro</a></p></blockquote><h2 id="openTSDB-grafana"><a href="#openTSDB-grafana" class="headerlink" title="openTSDB+grafana"></a>openTSDB+grafana</h2><p><code>参考</code></p><blockquote><p><a href="https://blog.csdn.net/u011537073/article/details/54565742" target="_blank" rel="noopener">https://blog.csdn.net/u011537073/article/details/54565742</a></p></blockquote><h2 id="tableau"><a href="#tableau" class="headerlink" title="tableau"></a>tableau</h2><p><code>付费</code> </p><blockquote><p><a href="https://www.tableau.com/support/help" target="_blank" rel="noopener">https://www.tableau.com/support/help</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;大数据平台监控工具&quot;&gt;&lt;a href=&quot;#大数据平台监控工具&quot; class=&quot;headerlink&quot; title=&quot;大数据平台监控工具&quot;&gt;&lt;/a&gt;大数据平台监控工具&lt;/h1&gt;&lt;h2 id=&quot;Prometheus-grafana&quot;&gt;&lt;a href=&quot;#Prometh
      
    
    </summary>
    
      <category term="大数据平台监控" scheme="https://tgluon.github.io/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E7%9B%91%E6%8E%A7/"/>
    
    
      <category term="大数据平台监控" scheme="https://tgluon.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B9%B3%E5%8F%B0%E7%9B%91%E6%8E%A7/"/>
    
  </entry>
  
  <entry>
    <title>环境变量配置</title>
    <link href="https://tgluon.github.io/2018/07/22/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE/"/>
    <id>https://tgluon.github.io/2018/07/22/环境变量配置/</id>
    <published>2018-07-22T15:10:10.000Z</published>
    <updated>2018-07-24T10:18:23.016Z</updated>
    
    <content type="html"><![CDATA[<h1 id="java环境变量配置"><a href="#java环境变量配置" class="headerlink" title="java环境变量配置"></a>java环境变量配置</h1><h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><h3 id="方式一-常用"><a href="#方式一-常用" class="headerlink" title="方式一(常用):"></a>方式一(常用):</h3><p>变量名：JAVA_HOME<br>变量值：D:\Program Files\Java\jdk1.8.0_73<br>变量名：PATH<br>变量值：%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin<br>变量名：classpath<br>变量值：.,%JAVA_HOME%\lib;%JAVA_HOME%\lib\dt.jar;  %JAVA_HOME%\lib\tools.jar  </p><h3 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h3><p>path:<br>D:\Program Files\Java\jdk1.8.0_60\bin<br>classpath:<br>D:\Program Files\Java\jdk1.8.0_60\lib<br>javac</p><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p>JAVA_HOME=/home/hadoop/java/jdk1.8.0_73<br>CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br>PATH=$PATH:$JAVA_HOME/bin<br>export JAVA_HOME CLASSPATH   </p><h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p>在命令行输入一下命令进行验证：<br>1.java<br>2.javac   </p><h2 id="查看版本号"><a href="#查看版本号" class="headerlink" title="查看版本号"></a>查看版本号</h2><h1 id="maven环境变量配置"><a href="#maven环境变量配置" class="headerlink" title="maven环境变量配置"></a>maven环境变量配置</h1><h2 id="windows-1"><a href="#windows-1" class="headerlink" title="windows"></a>windows</h2><p><code>MAVEM_HOME</code><br>D:\Program Files\maven<br><code>path</code><br>%MAVEN_HOME%\bin<br>注意：%MAVEN_HOME%\bin 应该放在path的最前面。   </p><h2 id="linux-1"><a href="#linux-1" class="headerlink" title="linux"></a>linux</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MAVEN_HOME=/home/hadoop/maven     </span><br><span class="line">PATH=$PATH:$MAVEN_HOME/bin</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;java环境变量配置&quot;&gt;&lt;a href=&quot;#java环境变量配置&quot; class=&quot;headerlink&quot; title=&quot;java环境变量配置&quot;&gt;&lt;/a&gt;java环境变量配置&lt;/h1&gt;&lt;h2 id=&quot;windows&quot;&gt;&lt;a href=&quot;#windows&quot; class
      
    
    </summary>
    
      <category term="环境变量配置" scheme="https://tgluon.github.io/categories/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE/"/>
    
    
      <category term="java" scheme="https://tgluon.github.io/tags/java/"/>
    
  </entry>
  
</feed>
